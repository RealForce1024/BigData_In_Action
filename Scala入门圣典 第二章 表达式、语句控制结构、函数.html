<!DOCTYPE html><html><head><title>Scala入门圣典 第二章 表达式、语句控制结构、函数</title><meta charset='utf-8'><link href='https://dn-maxiang.qbox.me/res-min/themes/marxico.css' rel='stylesheet'><style>
.note-content  {font-family: 微软雅黑, 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, Song, sans-serif;}

</style></head><body><div id='preview-contents' class='note-content'>
                        <div id="wmd-preview" class="preview-content"></div>
                    <div id="wmd-preview-section-20913" class="wmd-preview-section preview-content">

</div><div id="wmd-preview-section-20976" class="wmd-preview-section preview-content">

<h2 id="scala入门圣典-第二章-表达式语句控制结构函数">Scala入门圣典 第二章 表达式、语句控制结构、函数</h2>

<p>在Java或其他语言中，表达式和语句是本质区别的。表达式有值(例如1+1)，语句执行动作(例如if语句)。  <br>
Scala语言则有很大的不同，<strong>几乎任何被构造出来的语法结构都有值</strong>。正是因为有了该特性，Scala程序才会更加精简易读。</p></div><div id="wmd-preview-section-20915" class="wmd-preview-section preview-content">

<h3 id="1-if表达式的值">1. if表达式的值</h3>

<p>更确切的说是if表达式执行后的结果返回值。</p>

</div><div id="wmd-preview-section-20916" class="wmd-preview-section preview-content">

<h4 id="两种形式">两种形式</h4>

<p><strong>第一种形式</strong></p>

</div><div id="wmd-preview-section-20917" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs"><span class="hljs-keyword">val</span> x = <span class="hljs-number">101</span><br>scala&gt; <span class="hljs-keyword">if</span>(x&gt;<span class="hljs-number">100</span>) <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>res34: <span class="hljs-type">Int</span> = <span class="hljs-number">1</span><br><br>scala&gt; <span class="hljs-keyword">if</span> x&gt;<span class="hljs-number">100</span> <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span>   <span class="hljs-comment">//注意不要写嗨了连if后的（）后省略了。这里真不能省</span><br>&lt;console&gt;:<span class="hljs-number">1</span>: error: '(' expected but identifier found.<br>       <span class="hljs-keyword">if</span> x&gt;<span class="hljs-number">100</span> <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>          ^<br></code></pre>

<p>在Scala中是避免使用return的。 <br>
上面的写法是原汁原味的，尽量不要写出类似Java的用法了</p>

<p>注意下面的程序，有以下几点需要注意</p>

<ol><li rel="1">var类型的定义场景。第一种写法更好是因为可以直接定义val值，而第二种写法则是必须定义为var</li>
<li rel="2">代码格式化</li>
<li rel="3">尽量不要在最后的语句中赋值变量，否则语句的值就变得没什么意义了，最好将语句赋值给变量或值。</li>
</ol>

<p><strong>第二种形式</strong></p>

</div><div id="wmd-preview-section-20918" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="hljs cpp">scala&gt; val y = <span class="hljs-number">0</span><br>y: Int = <span class="hljs-number">0</span><br><br>scala&gt; <span class="hljs-keyword">if</span>(x&gt;<span class="hljs-number">100</span>) y=<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> y=-<span class="hljs-number">1</span><br>&lt;console&gt;:<span class="hljs-number">10</span>: error: <span class="hljs-function">reassignment to val<br>              <span class="hljs-title">if</span><span class="hljs-params">(x&gt;<span class="hljs-number">100</span>)</span> y</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> y=-<span class="hljs-number">1</span><br>                         ^<br>&lt;console&gt;:<span class="hljs-number">10</span>: error: value =- <span class="hljs-function">is not a member of Int<br>              <span class="hljs-title">if</span><span class="hljs-params">(x&gt;<span class="hljs-number">100</span>)</span> y</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> y=-<span class="hljs-number">1</span><br>                                  ^<br><br>scala&gt; var y = <span class="hljs-number">0</span><br>y: Int = <span class="hljs-number">0</span><br><br>scala&gt; <span class="hljs-keyword">if</span>(x&gt;<span class="hljs-number">100</span>) y=<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> y=-<span class="hljs-number">1</span><br>&lt;console&gt;:<span class="hljs-number">10</span>: error: value =- <span class="hljs-function">is not a member of Int<br>              <span class="hljs-title">if</span><span class="hljs-params">(x&gt;<span class="hljs-number">100</span>)</span> y</span>=<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> y=-<span class="hljs-number">1</span><br>                                  ^<br><br>scala&gt; <span class="hljs-keyword">if</span>(x&gt;<span class="hljs-number">100</span>) y=<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> y= -<span class="hljs-number">1</span><br><br>scala&gt; y<br>res42: Int = <span class="hljs-number">1</span><br></code></pre>

<p>与三目运算符的对比 <br>
<code>int m = 0; m = m&gt;1? 1:-1;</code> Java中三目运算符<code>?:</code>，与上面的代码效果是一样的，反而更加精简，但是<code>?:</code>不能再插入语句。</p>

<p>可以说是Scala中将if else与三目运算结合起来了。并且威力更加强大了，例如可以混合类型的表达式</p>

</div><div id="wmd-preview-section-20919" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; <span class="hljs-keyword">val</span> x = <span class="hljs-number">1</span><br>x: <span class="hljs-type">Int</span> = <span class="hljs-number">1</span><br><br>scala&gt; <span class="hljs-keyword">if</span> (x&gt;<span class="hljs-number">0</span>) <span class="hljs-string">"positive"</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>res43: <span class="hljs-type">Any</span> = positive<br></code></pre>

</div><div id="wmd-preview-section-20920" class="wmd-preview-section preview-content">

<h4 id="返回值类型">返回值类型</h4>

<p>注意</p>

</div><div id="wmd-preview-section-20921" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; <span class="hljs-keyword">if</span> (x&gt;<span class="hljs-number">0</span>) <span class="hljs-string">"positive"</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>res43: <span class="hljs-type">Any</span> = positive<br></code></pre>

<p>“positive” -&gt;java.lang.String <br>
   -1-&gt; Int <br>
   <strong>if语句的返回值类型是String与Int类型的公共超类型Any</strong></p>

</div><div id="wmd-preview-section-20922" class="wmd-preview-section preview-content">

<h4 id="unit">Unit ()</h4>

<p>如果else缺失，而if条件又不满足 <br>
语句的返回值类型将是Unit, 写作: ()，相当于Java中的void。但是本质上还是有些区别，Unit代表“无有用值”，而void是空的，类比：空的钱包与一张写有“没钱”的无面值的钞票。</p>

</div><div id="wmd-preview-section-20923" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; <span class="hljs-keyword">val</span> x = <span class="hljs-number">99</span><br>x: <span class="hljs-type">Int</span> = <span class="hljs-number">99</span><br><br>scala&gt; <span class="hljs-keyword">if</span> (x&gt;<span class="hljs-number">100</span>) <span class="hljs-number">1</span> <br>res0: <span class="hljs-type">AnyVal</span> = ()<br></code></pre>

<p>其实相当于</p>

</div><div id="wmd-preview-section-20924" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; <span class="hljs-keyword">if</span> (x&gt;<span class="hljs-number">100</span>) <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> () <br>res0: <span class="hljs-type">AnyVal</span> = ()<br></code></pre>

</div><div id="wmd-preview-section-20925" class="wmd-preview-section preview-content">

<h3 id="2-repl的近视问题">2. REPL的“近视问题”</h3>

<p>在REPL中，执行以下形式代码的时候</p>

</div><div id="wmd-preview-section-20926" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; <span class="hljs-keyword">val</span> x = <span class="hljs-number">99</span><br>x: <span class="hljs-type">Int</span> = <span class="hljs-number">99</span><br><br>scala&gt; <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">100</span>) <span class="hljs-number">1</span><br>res3: <span class="hljs-type">AnyVal</span> = ()<br><br>scala&gt; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x == <span class="hljs-number">100</span>) <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>&lt;console&gt;:<span class="hljs-number">1</span>: error: illegal start of definition<br>       <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x == <span class="hljs-number">100</span>) <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>       ^<br></code></pre>

<p>由于REPL解释器的“近视问题”导致</p>

</div><div id="wmd-preview-section-20927" class="wmd-preview-section preview-content">

<h4 id="两种方案解决repl的近视问题">两种方案解决REPL的”近视问题”</h4>

</div><div id="wmd-preview-section-20928" class="wmd-preview-section preview-content">

<h5 id="1">1. {}</h5>

</div><div id="wmd-preview-section-20929" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; <span class="hljs-keyword">val</span> x =<span class="hljs-number">99</span><br>x: <span class="hljs-type">Int</span> = <span class="hljs-number">99</span><br><br>scala&gt; <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">100</span>) {<span class="hljs-number">1</span><br>     | } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x ==<span class="hljs-number">100</span>) <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>res1: <span class="hljs-type">Int</span> = -<span class="hljs-number">1</span><br></code></pre>

</div><div id="wmd-preview-section-20930" class="wmd-preview-section preview-content">

<h5 id="2-pase指令">2. :pase指令</h5>

<p>该指令可以允许你粘贴或编写一段代码执行，非常方便。ctrl+d后执行</p>

</div><div id="wmd-preview-section-20931" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; :paste<br><span class="hljs-comment">// Entering paste mode (ctrl-D to finish)</span><br><br><span class="hljs-keyword">if</span>(x &gt; <span class="hljs-number">100</span>) <span class="hljs-number">1</span><br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x ==<span class="hljs-number">100</span>) <span class="hljs-number">1</span><br><span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br><br><span class="hljs-comment">// Exiting paste mode, now interpreting.</span><br><br>res2: <span class="hljs-type">Int</span> = -<span class="hljs-number">1</span><br></code></pre>

</div><div id="wmd-preview-section-20932" class="wmd-preview-section preview-content">

<h3 id="3-scala语句的终止">3. Scala语句的终止</h3>

</div><div id="wmd-preview-section-20933" class="wmd-preview-section preview-content">

<h4 id="1-无需">1. 无需<code>;</code></h4>

<p>在Java中一行语句的结尾是以<code>;</code>结束的。Scala则像大多数的脚本语言一样无需<code>;</code>直接结束。</p>

</div><div id="wmd-preview-section-20934" class="wmd-preview-section preview-content">

<h4 id="2-单行多语句采用">2. 单行多语句采用<code>;</code></h4>

</div><div id="wmd-preview-section-20935" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; <span class="hljs-keyword">var</span> x = <span class="hljs-number">99</span><br>x: <span class="hljs-type">Int</span> = <span class="hljs-number">99</span><br><br>scala&gt; <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">100</span>) x*<span class="hljs-number">100</span>; x += <span class="hljs-number">1</span><br><br>scala&gt; x<br>res8: <span class="hljs-type">Int</span> = <span class="hljs-number">100</span><br></code></pre>

</div><div id="wmd-preview-section-20936" class="wmd-preview-section preview-content">

<h4 id="3-较长的语句选择适当的标识符表示未结束">3. 较长的语句，选择适当的标识符表示未结束</h4>

<p>较长语句，一行不想写完，较好的选择是采用操作符表示该行未结束 <br>
注意：REPL的”近视问题”</p>

</div><div id="wmd-preview-section-20937" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; <span class="hljs-keyword">var</span> y = <span class="hljs-number">0</span> <br>y: <span class="hljs-type">Int</span> = <span class="hljs-number">0</span><br><br>scala&gt; y = y*<span class="hljs-number">100</span>-<span class="hljs-number">10</span>+<span class="hljs-number">99</span> +<br>&lt;console&gt;:<span class="hljs-number">8</span>: error: <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">mismatch</span>;</span><br> found   : (x: <span class="hljs-type">Double</span>)<span class="hljs-type">Double</span> &lt;and&gt; (x: <span class="hljs-type">Float</span>)<span class="hljs-type">Float</span> &lt;and&gt; (x: <span class="hljs-type">Long</span>)<span class="hljs-type">Long</span> &lt;and&gt; (x: <span class="hljs-type">Int</span>)<span class="hljs-type">Int</span> &lt;and&gt; (x: <span class="hljs-type">Char</span>)<span class="hljs-type">Int</span> &lt;and&gt; (x: <span class="hljs-type">Short</span>)<span class="hljs-type">Int</span> &lt;and&gt; (x: <span class="hljs-type">Byte</span>)<span class="hljs-type">Int</span> &lt;and&gt; (x: <span class="hljs-type">String</span>)<span class="hljs-type">String</span><br> required: <span class="hljs-type">Int</span><br>       y = y*<span class="hljs-number">100</span>-<span class="hljs-number">10</span>+<span class="hljs-number">99</span> +<br>                       ^<br><br>scala&gt; :paste<br><span class="hljs-comment">// Entering paste mode (ctrl-D to finish)</span><br><br>y = y*<span class="hljs-number">100</span>-<span class="hljs-number">10</span>+<span class="hljs-number">0</span> +<br><span class="hljs-number">100</span><br><br><span class="hljs-comment">// Exiting paste mode, now interpreting.</span><br><br>y: <span class="hljs-type">Int</span> = <span class="hljs-number">90</span><br></code></pre>

</div><div id="wmd-preview-section-20938" class="wmd-preview-section preview-content">

<h4 id="左花括号结尾的风格">左花括号结尾的风格</h4>

<p>在实际编码中，有两种花括号的使用风格</p>

</div><div id="wmd-preview-section-20939" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs"><span class="hljs-keyword">if</span>(x&gt;<span class="hljs-number">100</span>){<br>    println(<span class="hljs-string">"&gt;100"</span>)<br>}<br></code></pre>

<p>另一种在C#中推荐</p>

</div><div id="wmd-preview-section-20940" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs"><span class="hljs-keyword">if</span>(x&gt;<span class="hljs-number">100</span>)<br>{<br>    println(<span class="hljs-string">"&gt;100"</span>)<br>}<br></code></pre>

<p>而Scala和Java程序员为了解决较长语句时一行写不完或长表达式涉及函数或方法调用时过长的问题，Scala程序员更倾向于第一种风格写法。其有个学名：Kernighan&amp;Ritchie风格的花括号。 <br>
以<code>{</code>结尾的语句表明了后面还有更多的内容。</p>

</div><div id="wmd-preview-section-20941" class="wmd-preview-section preview-content">

<h3 id="4-块表达式">4. 块表达式</h3>

<p>被<code>{}</code>包围的称之为块表达式，在逻辑分支或循环中放置很多个动作的时候，都可以使用语句块。</p>

<p>块表达式 顾名思义，有很多个表达式组成的语句段落，包含一系列的表达式。<strong>其结果也是个表达式，最后一个表达式的值就是块表达式的值。</strong></p>

<p>对于初始化一个值时需要很多中间变量的时候，块表达式可以很好的胜任。 <br>
<code>val distance = {val dx = x - x0; val dy = y - y0; sqrt(dx*dx + dy*dy)}</code> <br>
其中dx,dy只是作为中间计算值，使用完就抛弃了，这里稍许可以联想到优化的部分，对象的生命周期相当短暂。</p>

<p><strong>在实际工作中，尽量避免太长的复杂的单行语句，不利于维护。</strong></p>

</div><div id="wmd-preview-section-20942" class="wmd-preview-section preview-content">

<h3 id="5-赋值语句的返回值-unit">5. 赋值语句的返回值 Unit</h3>

<p>Scala赋值语句返回值是Unit的 () <br>
所以尽量不要 x = y = 1,很容易导致错误，因为x大多数情况非Unit类型</p>

</div><div id="wmd-preview-section-20943" class="wmd-preview-section preview-content">

<pre class="prettyprint hljs-light"><code class="language-scala hljs">scala&gt; <span class="hljs-keyword">var</span> x,y = <span class="hljs-number">0</span><br>x: <span class="hljs-type">Int</span> = <span class="hljs-number">0</span><br>y: <span class="hljs-type">Int</span> = <span class="hljs-number">0</span><br><br>scala&gt; x = y = <span class="hljs-number">1</span><br>&lt;console&gt;:<span class="hljs-number">9</span>: error: <span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">mismatch</span>;</span><br> found   : <span class="hljs-type">Unit</span><br> required: <span class="hljs-type">Int</span><br>       x = y = <span class="hljs-number">1</span><br>             ^<br></code></pre></div><div id="wmd-preview-section-footnotes" class="preview-content"></div></div></body></html>